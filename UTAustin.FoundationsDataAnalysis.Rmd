---
title: "EdX"
author: "Anita Owens"
date: "February 9, 2016"
output: html_document
---
UTAustinX: UT.7.10x Foundations of Data Analysis - Part 1
Subsetting: http://www.statmethods.net/management/subset.html
```{r}
setwd("/Users/anitaowens/Documents/R")
install.packages("SDSFoundations")
library("SDSFoundations")
bike<-read.csv("BikeData.csv")
```
Prepare for the Analysis
```{r}
# Find the number of students in the dataset
table(bike$student)
#14 students

# Pull out student data into a new dataframe
student <-bike[bike$student==1,]

# Find how often the students ride, using the new dataframe
table(student$cyc_freq)
 #Daily  Less than once a month 
 #                     8                       0 
#Several times per month  Several times per week 
  #                    0                       6 

# Create a vector for the distance variable
distance <-student$distance
#[1]  3.25 10.94  9.34  1.25  9.29  2.77  4.84  6.56  0.85  6.07  3.52
#[12] 13.43  7.19  8.31

# Find average distance ridden
mean(distance)
#6.257857

```
Select the question that will require subsetting the data.
```{r}
riders<-BikeData[ which(BikeData$cyc_freq=="Daily"),]
nrow(riders)
```

What is the average age of daily riders? 
```{r}
mean(riders$age)
round(mean(riders$age), digits = 1)
```
How many of the daily riders are male?
```{r}
sum(with(riders, gender=="M"))
sum(with(riders, gender=="F"))
```
What is the average age of the female daily riders? (Round to 1 decimal place)
```{r}
female<-riders[ which(riders$gender=="F"),]
round(mean(female$age), digits = 1)
```
 What is the average age of the male daily riders? (Round to 1 decimal place.)
 
```{r}
male<-riders[ which(riders$gender=="M"),]
round(mean(male$age), digits = 1)
```
 thirty <- bike[bike$age >= 30,]
 How many daily male riders are age 30 or older?
 ```{r}
thirty<-male[male$age >= 30,]
nrow(thirty)
```
is this normal
```{r}

```
animal data
```{r}
#number of variables
ncol(AnimalData)
```
how many were adopted
```{r}
adopt<-AnimalData[1:10,]
sum(with(adopt, Outcome.Type=="Adoption"))
```
plot
```{r}
plot(AnimalData$Animal.Type, AnimalData$Weight, main="Test123")

```
comprehension check
```{r}
workers<-c(10, 2, 6, 12,   14,   15,   15,   24,   15,   25,   3,   12)

mean(workers)
round(mean(workers), digits = 1)
round(sd(workers),digits=2)
round(sd(workers),digits=1)
median(workers)
summary(workers)

range(workers, na.rm = FALSE)
IQR(workers)

plot(workers)
library(ggplot2)
overtime<-as.data.frame(workers)
ggplot(overtime, aes(x=workers)) + geom_histogram(binwidth = .5, color="black", fill="white") + geom_vline(aes(xintercept=mean(overtime, na.rm=T)), color="red", linetype="dashed", size=1)
```
AnimalData Exercises
```{r}
#Find the number of animals that were adopted
table(AnimalData$Outcome.Type)

#Pull out only adopted animals
adopted <- AnimalData[AnimalData$Outcome.Type=="Adoption",]

#Pull out just the days in shelter for the adopted animals
daystoadopt <- adopted$Days.Shelter

#Visualize and describe this variable
hist(daystoadopt)
fivenum(daystoadopt)
mean(daystoadopt)
sd(daystoadopt)
which(AnimalData$Days.Shelter==max(daystoadopt))

#. How would you describe the shape of the distribution of daystoadopt?
#positively skewed-the right tail is longer (right skewed)

IQR(daystoadopt)

mean(adopted$Days.Shelter)
#What was the z-score for this particular animal? Round to the nearest TWO decimal places.
211-mean(adopted$Days.Shelter)
round(181.7353/sd(adopted$Days.Shelter), digits = 2)
#The middle 50% of the distribution were adopted between 8 and 38 days
```
Univariate Descriptive Statistics
```{r}
#subsetting dogs
dogs<-AnimalData[ which(AnimalData$Animal.Type=='Dog' & AnimalData$Age.Intake >= 1),]
nrow(dogs)

#subsetting dats
cats<-AnimalData[ which(AnimalData$Animal.Type=='Cat' & AnimalData$Age.Intake >= 1),]
nrow(cats)
```
weight
```{r}
dogweight<-dogs$Weight
hist(dogweight)

catweight<-cats$Weight
hist(catweight)

summary(dogweight)
summary(catweight)

round(mean(catweight), digits = 1)
round(sd(catweight), digits=2)
```
What is the z-score of a 13 pound adult cat? Round to one decimal point.
```{r}
13-mean(catweight)
round(4.396429/sd(catweight), digits = 1)
```
What proportion of adult cats weigh more than 13 pounds, according to your data? Use the following code to answer this question: 1-pnorm(zcat). Replace "zcat" with your z-score for the cat. Round to three decimal places.
```{r}
zcat<-round(4.396429/sd(catweight), digits = 1)
1-pnorm(zcat)
#[1] 0.01072411
round(1-pnorm(zcat), digits = 3)
```
About 95% of adult cats at the shelter weigh between?
4.8 and 12.4lbs

 ```{r}
quantile(catweight, c(.05, .25, .5, .90, .95))
quantile(catweight, c(.00, .05, .25, .5, .90, .95, 1.00))
```
What was the most common way that dogs arrived in the shelter? (as defined by the “Intake.Type” variable)
```{r}
table(dogs$Intake.Type)
```
What proportion of dogs were brought to the shelter as an owner surrender? (Round to 3 decimal places.)
```{r}
round(58/226, digits = 3)
#answer 0.278

sdogs<-round(zscore/sd(dogs$Intake.Type), digits = 3)
1-pnorm(sdogs)

round(1-pnorm(sdogs), digits = 3)

```
Of the dogs that were brought to the shelter as an owner surrender, how many were returned to their owner?
```{r}
returndogs<-dogs[ which(dogs$Intake.Type=='Owner Surrender' & dogs$Outcome.Type == "Return to Owner"),]
nrow(returndogs)

```
Question3
```{r}
x<-c(2,2,3,5,6,7,9,14,15,18)
y<-c(2,2,3,5,6,8,9,14,15,18)
```
Week 3 Bivariate Data
```{r}
#import data
BullRiders<-read.csv("BullRiders.csv")
```
Info about the dataset
```{r}
nrow(BullRiders)
```
How many of the first 10 riders in the dataset have been pro for 10 years or more?
```{r}
head(BullRiders)
pro<-BullRiders[1:10,]
plus10<-pro[ which(pro$YearsPro >= 10),]
nrow(plus10)
```
Of the top 15 riders so far in 2015, how many rides were completed by the rider with the fewest buck-outs in 2014?
```{r}
names(BullRiders)
top15<-BullRiders[1:15,]
buck2014<-subset(top15, select=c(Rider, Rank15, BuckOuts14, Rides14))
#sort from lowest to highest
```
Breakdown of Analysis
```{r}
#import data
bull<-read.csv("BullRiders.csv")

#Subset for riders that participated in at least one event in 2013
new_bull <- bull[bull$Events13  > 0 ,]

# Visualize and describe the first variable of interest
hist(new_bull$Rides13)
fivenum(new_bull$Rides13)
mean(new_bull$Rides13)
sd(new_bull$Rides13)

# Visualize and describe the second variable of interest
hist(new_bull$Top10_13)
fivenum(new_bull$Top10_13)
mean(new_bull$Top10_13)
sd(new_bull$Top10_13)

# Create a scatterplot
plot(new_bull$Rides13,new_bull$Top10_13)

# Add line of best fit
abline(lm(new_bull$Top10_13~new_bull$Rides13))

# Calculate the correlation coefficient
cor(new_bull$Rides13,new_bull$Top10_13)

# Create a correlation matrix 
vars <- c("Top10_13", "Rides13")
cor(new_bull[,vars])
round(cor(new_bull[,vars]), digits = 3)
```
Which cases will be selected by this line of code?
```{r}
new_bull <- bull[bull$Events13 > 0 ,]
#riders that have completed more than zero Events in 2013
```
In the above scatterplot, why does the line of best fit seem to not be going through the center of the scatterpot? (Refer to the code below and the dataset in R for help.)
```{r}
plot(bull$Events12, bull$BuckOuts12)
abline(lm(bull$Events12~bull$BuckOuts12))

#corrected code
plot(bull$Events12, bull$BuckOuts12)
abline(lm(bull$BuckOuts12~bull$Events12))
```
A correlation matrix allows you to calculate multiple correlation coefficients at a time. Here, we are only asking for the correlation between Rides13 and Top10_13. If you wanted to include other variables as well, how would you do that?
```{r}
# Create a correlation matrix
vars <-c("Top10_13", "Rides13")
cor(new_bull[,vars])

```
On average, a bull rider in 2013 has how many rides? (Report the median becuase the histogram is not symmetrical.)
```{r}
median(new_bull$Rides13)
```
1b. These bull riders made it into the Top 10 an average of ________ times in 2013. (Hint: Remember again that the histogram is not symmetrical.)
```{r}
mean(new_bull$Top10_13)
```
Use this code to help identify this rider:
#identify a specific record 
```{r}
#identify a specific record
which(new_bull$Top10_13==2 & new_bull$Rides13==22)
record<-new_bull[4,]
```
Create a dataset which contains riders that participated in at least one event in 2012. Call the dataset new_bull12.
```{r}
new_bull12<-BullRiders[ which(BullRiders$Events12 > 0),]
```
Make a histogram to visualize the distribution of Earnings for 2012.
```{r}
hist(new_bull12$Earnings12)
```
Generate the appropriate descriptive statistics for this distribution
```{r}
fivenum(new_bull12$Earnings12)
mean(new_bull12$Earnings12)
sd(new_bull12$Earnings12)
median(new_bull12$Earnings12)
```
1b. What was the average amount earned by a bull rider? (Choose the appropriate measure of center; report without a $ sign and round to the nearest whole number.)
```{r}
round(median(new_bull12$Earnings12), digits = 0)
```
What was the highest amount earned by a bull rider? (Report without a $ sign and round to the nearest whole number.)
```{r}
which.max(new_bull12$Earnings12)

#see which row is the highest earner
high<-new_bull12[4,]
#Silvano Alves

#subsetting income earnings for 2012
earnings<-subset(new_bull12, select = c(Rider, Rank15, Earnings12))
#then sort from highest to lowest

round(1464475.61, digits = 0)
```
Make a Scatterplot of Earnings and Ride Percentage
```{r}
plot(new_bull12$Earnings12,new_bull12$RidePer12)
```
correlation matrix
```{r}
# Create a correlation matrix
vars <-c("Earnings12", "RidePer12")
round(cor(new_bull12[,vars]), digits = 3)
```
Create a Scatterplot of Earnings and Cup Points
```{r}
plot(new_bull12$Earnings12,new_bull12$CupPoints12)
abline(lm(new_bull12$CupPoints12~new_bull12$Earnings12), col="red")
```
correlation matrix
```{r}
vars <-c("Earnings12", "CupPoints12")
round(cor(new_bull12[,vars]), digits = 3)
```
Outliers and Influential Points

An outlier can have a significant impact on the correlation coefficient. Sometimes it is important to remove these points to examine the size of this impact. Run this code to identify the extreme data value in Earnings:
```{r}
# identify specific case
which(new_bull12$Earnings12 == max(new_bull12$Earnings12))
```
plot
```{r}
plot(new_bull12$RidePer12, new_bull12$Earnings12)
abline(lm(new_bull12$Earnings12~new_bull12$RidePer12), col="red")
```
Let's remove this data point from the dataset to assess what kind of impact, if any, it had on our correlation analysis. Run this code:
```{r}
#Subset the data
nooutlier <- new_bull12[new_bull12$Earnings12 < 1000000 ,] 
```
Then rerun the correlation matrix and the scatterplots to see the difference. Make sure to use the new dataframe (nooutlier) that you just created.
```{r}
#correlation matrix
vars <-c("Earnings12", "RidePer12")
round(cor(nooutlier[,vars]), digits = 3)

#scatterplot
plot(nooutlier$RidePer12, nooutlier$Earnings12)
abline(lm(nooutlier$Earnings12~nooutlier$RidePer12), col="red")
```
After removing the outlier, what was the new correlation of Earnings and Cup Points for 2012? (Round to three decimals)
```{r}
#correlation matrix
vars <-c("Earnings12", "CupPoints12")
round(cor(nooutlier[,vars]), digits = 3)
```
Answer the question and support your answer with statistics:

An initial examination of the relationships between Ride Percentage (RidePer) and Earnings, and Cup Points (CupPoints) and Earnings showed that Cup Points had the  
stronger - This answer is correct. stronger relationship to Earnings. Ride Percentage and Earnings showed a correlation value of   
0.593 - This answer is correct. 0.593 while Cup Points and Earnings had a correlation value of   
0.657 - This answer is correct. 0.657 . Visual examination showed an   
outlier - This answer is correct. outlier in both relationships—a rider who has earned over 1 million dollars. Removal of this increased the initial relationship: Ride Percentage and Earnings now had a correlation value of  
0.804 - This answer is correct. 0.804 and Cup Points and Earnings had a correlation value of  
0.893 - This answer is correct. 0.893 .   
Cup Points - This answer is correct. Cup Points still had the higher relationship to Earnings. Visual examination showed a  
good linear relationship - This answer is correct. good linear relationship for both Ride Percentage and Cup Points, indicating the correct use of the correlation coefficient.
